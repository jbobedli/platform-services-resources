{{- $adminAuthSecret := .Values.adminAuthSecret }}
{{- $defaultTemplate := .Values.defaultTemplate }}
{{- $defaultClusterName := .Values.defaultClusterName }}
{{- range $cache := .Values.caches }}
apiVersion: infinispan.org/v2alpha1
kind: Cache
metadata:
  name: {{ lower ( replace "." "-" (printf "gw-%s" cache.name) ) }}
spec:
  {{- if $adminAuthSecret }}
  adminAuth:
    secretName: {{- $adminAuthSecret }}
  {{- end }}
  clusterName:  {{ default $defaultClusterName $cache.clusterName }}
  name: {{ lower ( replace "." "-" (printf "gw-%s" cache.name) ) }}
  {{- if $cache.templateName }}
  templateName: {{ $cache.templateName }}
  {{- else}}
  template : {{ default $defaultTemplate $cache.template }}
  {{- end }}
{{- end }}